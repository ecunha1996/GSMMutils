function return_val = lipids_dag(lipidClass)


metmat = double(load('dag_metmat.mat').metmat);

% 
% lipidClass = {
% 'DAG__20_4__20_0', 'DAG__18_1__18_3v2', 'DAG__14_1__22_2', 'DAG__20_0__20_2', 'DAG__18_3__20_3', 'DAG__16_1__22_6', 'DAG__12_0__16_1', 'DAG__22_2__22_0', 'DAG__22_2__20_0', 'DAG__18_2__20_2', 'DAG__20_4__20_2', 'DAG__22_0__18_3', 'DAG__14_0__16_0', 'DAG__18_1__18_0', 'DAG__20_1__20_0', 'DAG__18_3__22_0', 'DAG__20_4__20_1', 'DAG__18_0__22_0', 'DAG__20_0__22_2', 'DAG__22_0__18_1', 'DAG__14_1__18_1', 'DAG__22_0__18_2', 'DAG__20_1__20_4', 'DAG__22_0__20_4', 'DAG__18_3__16_4', 'DAG__18_3__16_0', 'DAG__14_0__18_2', 'DAG__14_1__20_4', 'DAG__16_1__16_1', 'DAG__14_0__18_3', 'DAG__20_2__22_0', 'DAG__16_1__14_0', 'DAG__18_2__22_6', 'DAG__18_1__18_3', 'DAG__18_0__16_0', 'DAG__18_0__22_6', 'DAG__18_1__22_0', 'DAG__20_3__22_2', 'DAG__18_3__20_4', 'DAG__16_1__20_3', 'DAG__18_3__18_3', 'DAG__20_0__18_3', 'DAG__20_1__22_0', 'DAG__20_3__20_3', 'DAG__20_0__20_0', 'DAG__18_3__20_2', 'DAG__16_0__14_0', 'DAG__18_3v2__18_0', 'DAG__18_1__20_3', 'DAG__16_1__20_2', 'DAG__22_6__22_6', 'DAG__18_1__20_4', 'DAG__18_2__20_3', 'DAG__18_2__16_1', 'DAG__16_1__22_0', 'DAG__18_0__18_1', 'DAG__16_0__20_3', 'DAG__18_2__18_3', 'DAG__12_0__20_4', 'DAG__18_0__20_3', 'DAG__20_2__20_0', 'DAG__22_2__20_2', 'DAG__18_0__18_2', 'DAG__20_2__22_2', 'DAG__14_0__18_1', 'DAG__18_1__14_0', 'DAG__14_1__18_2', 'DAG__14_1__20_0', 'DAG__16_1__18_0', 'DAG__18_0__18_0', 'DAG__22_0__18_0', 'DAG__18_3__14_0', 'DAG__20_0__18_1', 'DAG__16_0__18_2', 'DAG__16_1__18_1', 'DAG__22_2__22_6', 'DAG__16_0__22_6', 'DAG__20_2__18_3', 'DAG__18_1__20_0', 'DAG__14_0__14_0', 'DAG__22_0__20_0', 'DAG__16_1__20_4', 'DAG__16_1__18_3v2', 'DAG__12_0__18_1', 'DAG__22_2__20_4', 'DAG__14_1__18_0', 'DAG__12_0__18_2', 'DAG__18_1__22_6', 'DAG__20_2__18_2', 'DAG__20_3__22_0', 'DAG__18_3__16_1', 'DAG__14_0__22_0', 'DAG__18_1__16_1', 'DAG__18_0__16_1', 'DAG__18_2__22_0', 'DAG__18_3v2__16_1', 'DAG__22_0__22_0', 'DAG__12_0__18_0', 'DAG__18_2__18_3v2', 'DAG__16_0__16_1', 'DAG__18_1__16_4', 'DAG__18_1__20_2', 'DAG__20_0__20_4', 'DAG__22_6__20_2', 'DAG__18_1__16_0', 'DAG__20_2__20_2', 'DAG__16_0__20_4', 'DAG__18_3__18_0', 'DAG__14_1__14_1', 'DAG__12_0__16_0', 'DAG__22_0__22_2', 'DAG__18_3__22_6', 'DAG__18_3v2__16_0', 'DAG__22_0__20_1', 'DAG__12_0__22_6', 'DAG__16_0__18_1', 'DAG__18_2__18_0', 'DAG__16_1__18_3', 'DAG__14_0__16_1', 'DAG__20_0__18_2', 'DAG__16_0__16_0', 'DAG__18_3__18_2', 'DAG__20_2__20_4', 'DAG__12_0__22_0', 'DAG__18_2__14_0', 'DAG__18_0__20_4', 'DAG__22_0__16_1', 'DAG__18_0__18_3v2', 'DAG__16_0__20_2', 'DAG__18_3__18_1', 'DAG__16_0__18_3', 'DAG__12_0__22_2', 'DAG__18_0__20_2', 'DAG__20_1__18_0', 'DAG__12_0__18_3', 'DAG__14_0__20_4', 'DAG__18_3v2__14_0', 'DAG__16_1__20_0', 'DAG__20_4__22_6', 'DAG__16_0__22_0', 'DAG__18_0__18_3', 'DAG__20_4__22_2', 'DAG__18_0__22_2', 'DAG__22_0__20_2', 'DAG__18_0__20_1', 'DAG__16_0__20_0', 'DAG__16_1__16_0', 'DAG__20_2__20_3', 'DAG__12_0__20_2', 'DAG__20_1__20_2', 'DAG__18_0__14_0', 'DAG__18_1__18_2', 'DAG__14_0__20_4', 'DAG__20_4__18_3', 'DAG__22_0__22_6', 'DAG__18_3v2__18_3v2', 'DAG__20_2__22_6', 'DAG__18_0__20_0', 'DAG__20_0__22_6', 'DAG__12_0__20_1', 'DAG__16_0__18_3v2', 'DAG__20_0__20_3', 'DAG__16_1__18_2', 'DAG__14_1__20_2', 'DAG__20_2__20_1', 'DAG__20_1__20_3', 'DAG__18_2__20_0', 'DAG__12_0__20_3', 'DAG__20_0__16_1', 'DAG__14_1__20_3', 'DAG__20_1__22_6', 'DAG__18_2__18_1', 'DAG__18_3__20_0', 'DAG__12_0__20_0', 'DAG__20_4__22_0', 'DAG__18_3v2__20_3', 'DAG__18_2__20_4', 'DAG__14_1__18_3', 'DAG__16_0__18_0', 'DAG__14_0__20_3', 'DAG__20_3__20_4', 'DAG__20_3__22_6', 'DAG__18_2__18_2', 'DAG__20_0__20_1', 'DAG__18_2__16_4', 'DAG__18_1__18_1', 'DAG__20_0__18_0', 'DAG__14_0__18_0', 'DAG__14_1__22_6', 'DAG__20_0__22_0', 'DAG__14_0__20_0', 'DAG__14_0__20_2', 'DAG__18_2__16_0',...
% 'DAG__18_3__18_1__chlo', 'DAG__18_3v2__16_0__chlo', 'DAG__18_3__16_0__chlo', 'DAG__18_2__18_1__chlo', 'DAG__18_2__16_0__chlo', ...
%     'DAG__18_1__18_1__chlo', 'DAG__18_1__16_0__chlo'
% };
% 
% 
% 
% 
% 
% metmat = [
% 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;
% 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0;
% 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,2,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,1,0,1;
% 0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,0,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,1,1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,1,0,2,1;
% 0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0;
% 0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0;
% 0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,2,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0;
% 1,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,1,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;
% 0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,2,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,1,0,0,0,0,0,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0;
% 0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;
% ];





% b = 2*[0.5, 0.0164, 0.0410, 0.0688, 0.1348, 0.0582, 0.0363, 0.0128, 0.1302, 0.0467, 0.0350, 0.0192, 0.0013, 0.0013, 0.0046, 0.0190, 0.0003, 0.3690, 0.0013, 0.0038]';

b = 2*[0.5, 0.0164, 0.0410, 0.0688, 0.1348, 0.0582, 0.0363, 0.0128, 0.1302, 0.0467, 0.0192, 0.0350, 0.0013, 0.0013, 0.0046, 0.0190, ...
    0.0003, 0.3690, 0.0013, 0.0038]';


[nExp, nMets] = size(metmat);

mdl2 = [];
mdl2.A = [
    sparse(metmat), speye(nExp), -speye(nExp);
    ];
mdl2.rhs = b;


mdl2.lb = zeros(nMets+nExp+nExp,1);
mdl2.ub = [ones(nMets, 1); 1000*ones(nExp*2,1)];

% ADD UPPER LIMITS FOR KNOWN LIPID CONFIGURATIONS
% % 

mdl2.lb(find(strcmp(lipidClass, 'DAG__18_3__18_1__chlo'))) = 0.0064;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_3__18_1__chlo'))) = 0.0127;

mdl2.lb(find(strcmp(lipidClass, 'DAG__18_3__18_1'))) = 0.0130;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_3__18_1'))) = 0.0260;


mdl2.lb(find(strcmp(lipidClass, 'DAG__18_3v2__16_0__chlo'))) = 0.0045;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_3v2__16_0__chlo'))) = 0.0089;

mdl2.lb(find(strcmp(lipidClass, 'DAG__18_3v2__16_0'))) = 0.0100;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_3v2__16_0'))) = 0.0201;



mdl2.lb(find(strcmp(lipidClass, 'DAG__18_3__16_0__chlo'))) = 0.0083;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_3__16_0__chlo'))) = 0.0166;


mdl2.lb(find(strcmp(lipidClass, 'DAG__18_3__16_0'))) = 0.0130;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_3__16_0'))) = 0.0260;


mdl2.lb(find(strcmp(lipidClass, 'DAG__18_2__18_1__chlo'))) = 0.0070;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_2__18_1__chlo'))) = 0.0140;


mdl2.lb(find(strcmp(lipidClass, 'DAG__18_2__18_1'))) = 0.0165;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_2__18_1'))) = 0.0330;


mdl2.lb(find(strcmp(lipidClass, 'DAG__18_2__16_0__chlo'))) = 0.00172;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_2__16_0__chlo'))) = 0.0344;


mdl2.lb(find(strcmp(lipidClass, 'DAG__18_2__16_0'))) = 0.0348;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_2__16_0'))) = 0.0696;


mdl2.lb(find(strcmp(lipidClass, 'DAG__18_1__18_1__chlo'))) = 0.0032;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_1__18_1__chlo'))) = 0.0064;


mdl2.lb(find(strcmp(lipidClass, 'DAG__18_1__18_1'))) = 0.0089;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_1__18_1'))) = 0.0177;


mdl2.lb(find(strcmp(lipidClass, 'DAG__18_1__16_0__chlo'))) = 0.0178;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_1__16_0__chlo'))) = 0.0357;


mdl2.lb(find(strcmp(lipidClass, 'DAG__18_1__16_0'))) = 0.0224;
mdl2.ub(find(strcmp(lipidClass, 'DAG__18_1__16_0'))) = 0.0449;


q = [1./b; 1./b];
mdl2.obj = [zeros(nMets,1); q];

error = 0.1;
mdl2.sense = '=';
% Constrain the errors based on known experimental error/noise
% x must sum to 1
mdl2.lb( [nMets+1, nMets+nExp+1]) = 0;
mdl2.ub( [nMets+1, nMets+nExp+1]) = 0;
%
relErrStoich = 0.05; %allow 5% deviation from sum of x
relErrFA = b(2:end);
relErrFA = (relErrFA.*error);% adds the error from the error argument
relErr = [relErrStoich;relErrFA];
mdl2.ub( nMets + 1:end) = [relErr;relErr];
% Solve
sol = gurobi(mdl2);


stoichs = sol.x(1:nMets);

ep = sol.x( nMets + (1:nExp) ); %upper error
en = sol.x( nMets + nExp + (1:nExp)); %lower error
errs = ep - en; 


LipidStoich = sol.x(1:length(lipidClass));
metIndex = [];
for i=1:length(LipidStoich)
    in = LipidStoich(i);
    if in ~= 0
        metIndex = [metIndex;i];
    end
end
StoichOut = LipidStoich(metIndex);
MetsOut = lipidClass(metIndex)';
TableOut = horzcat(MetsOut, num2cell(StoichOut));

writecell(TableOut, 'C:\Users\Bisbii\OneDrive - Universidade do Minho\Algae\Models\Dsalina\lipids\dag_opt_results.tsv', 'FileType', 'text','Delimiter','tab');
return_val = 'return';
end